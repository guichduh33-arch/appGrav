## ✅ [ISSUE-010] Missing Loading States Throughout Application - IMPLEMENTED

### Files Created/Modified

- ✅ `src/components/ui/LoadingSpinner.tsx`
- ✅ `src/components/ui/LoadingSkeleton.tsx`
- ✅ `src/hooks/useAsyncState.ts`
- ✅ `src/pages/pos/POSMenu.tsx` (example implementation)
- ✅ `src/pages/inventory/InventoryTable.tsx` (example implementation)
- ✅ `src/components/ui/Button.tsx` (loading state enhancement)

### Changes Summary

Implemented comprehensive loading states system with:
1. Reusable LoadingSpinner component with multiple sizes and colors
2. LoadingSkeleton component with variants for different content types
3. useAsyncState hook for managing loading/error states
4. Updated existing components to use proper loading states
5. Added loading button states for user actions

### Code Implementation

#### 1. LoadingSpinner Component

```tsx
// src/components/ui/LoadingSpinner.tsx
import React from 'react';

interface LoadingSpinnerProps {
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  color?: 'primary' | 'white' | 'gray' | 'success' | 'error';
  className?: string;
  label?: string;
}

export const LoadingSpinner: React.FC<LoadingSpinnerProps> = ({
  size = 'md',
  color = 'primary',
  className = '',
  label = 'Chargement...',
}) => {
  const sizeClasses = {
    xs: 'w-3 h-3 border',
    sm: 'w-4 h-4 border-2',
    md: 'w-8 h-8 border-2',
    lg: 'w-12 h-12 border-3',
    xl: 'w-16 h-16 border-4',
  };

  const colorClasses = {
    primary: 'border-blue-600 border-t-transparent',
    white: 'border-white border-t-transparent',
    gray: 'border-gray-600 border-t-transparent',
    success: 'border-green-600 border-t-transparent',
    error: 'border-red-600 border-t-transparent',
  };

  return (
    <div
      className={`
        inline-block
        ${sizeClasses[size]}
        ${colorClasses[color]}
        rounded-full animate-spin
        ${className}
      `}
      role="status"
      aria-label={label}
    >
      <span className="sr-only">{label}</span>
    </div>
  );
};

// Full page loading component
export const LoadingPage: React.FC<{ message?: string }> = ({ 
  message = 'Chargement de la page...' 
}) => (
  <div className="min-h-screen flex items-center justify-center bg-gray-50">
    <div className="text-center">
      <LoadingSpinner size="lg" />
      <p className="mt-4 text-gray-600">{message}</p>
    </div>
  </div>
);

// Overlay loading for modals/forms
export const LoadingOverlay: React.FC<{ 
  isVisible: boolean;
  message?: string;
  children: React.ReactNode;
}> = ({ isVisible, message = 'Traitement en cours...', children }) => (
  <div className="relative">
    {children}
    {isVisible && (
      <div className="absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50 rounded">
        <div className="text-center">
          <LoadingSpinner size="lg" />
          <p className="mt-2 text-gray-700 font-medium">{message}</p>
        </div>
      </div>
    )}
  </div>
);
```

#### 2. LoadingSkeleton Component

```tsx
// src/components/ui/LoadingSkeleton.tsx
import React from 'react';

interface LoadingSkeletonProps {
  variant?: 'text' | 'circular' | 'rectangular' | 'rounded';
  width?: string | number;
  height?: string | number;
  className?: string;
  animation?: 'pulse' | 'wave';
}

export const LoadingSkeleton: React.FC<LoadingSkeletonProps> = ({
  variant = 'rectangular',
  width = '100%',
  height = '1rem',
  className = '',
  animation = 'pulse',
}) => {
  const variantClasses = {
    text: 'rounded',
    circular: 'rounded-full',
    rectangular: '',
    rounded: 'rounded-md',
  };

  const animationClasses = {
    pulse: 'animate-pulse',
    wave: 'animate-pulse', // Could implement wave animation with CSS keyframes
  };

  return (
    <div
      className={`
        bg-gray-200
        ${variantClasses[variant]}
        ${animationClasses[animation]}
        ${className}
      `}
      style={{ width, height }}
      aria-label="Chargement du contenu..."
    />
  );
};

// Product Card Skeleton
export const ProductCardSkeleton: React.FC = () => (
  <div className="bg-white border border-gray-200 rounded-lg p-4 space-y-3">
    <LoadingSkeleton variant="rounded" height="160px" />
    <LoadingSkeleton variant="text" width="80%" height="1.25rem" />
    <LoadingSkeleton variant="text" width="60%" height="1rem" />
    <div className="flex justify-between items-center pt-2">
      <LoadingSkeleton variant="text" width="50%" height="1.5rem" />
      <LoadingSkeleton variant="rounded" width="80px" height="32px" />
    </div>
  </div>
);

// Table Row Skeleton
export const TableRowSkeleton: React.FC<{ columns: number }> = ({ columns }) => (
  <tr className="border-b border-gray-100">
    {Array.from({ length: columns }).map((_, i) => (
      <td key={i} className="p-4">
        <LoadingSkeleton variant="text" height="1rem" />
      </td>
    ))}
  </tr>
);

// List Item Skeleton
export const ListItemSkeleton: React.FC = () => (
  <div className="flex items-center space-x-3 p-4 border-b border-gray-100">
    <LoadingSkeleton variant="circular" width="40px" height="40px" />
    <div className="flex-1 space-y-2">
      <LoadingSkeleton variant="text" width="70%" height="1rem" />
      <LoadingSkeleton variant="text" width="50%" height="0.875rem" />
    </div>
    <LoadingSkeleton variant="rounded" width="60px" height="24px" />
  </div>
);

// Dashboard Card Skeleton
export const DashboardCardSkeleton: React.FC = () => (
  <div className="bg-white p-6 rounded-lg border border-gray-200">
    <div className="flex items-center justify-between mb-4">
      <LoadingSkeleton variant="text" width="40%" height="1.25rem" />
      <LoadingSkeleton variant="circular" width="32px" height="32px" />
    </div>
    <LoadingSkeleton variant="text" width="60%" height="2rem" />
    <div className="mt-2">
      <LoadingSkeleton variant="text" width="80%" height="0.875rem" />
    </div>
  </div>
);

// Chart Skeleton
export const ChartSkeleton: React.FC<{ height?: string }> = ({ 
  height = '300px' 
}) => (
  <div className="bg-white p-4 rounded-lg border border-gray-200">
    <div className="mb-4">
      <LoadingSkeleton variant="text" width="30%" height="1.25rem" />
    </div>
    <LoadingSkeleton variant="rounded" width="100%" height={height} />
  </div>
);
```

#### 3. useAsyncState Hook

```typescript
// src/hooks/useAsyncState.ts
import { useState, useCallback, useRef } from 'react';

interface AsyncState<T> {
  data: T | null;
  loading: boolean;
  error: Error | null;
}

interface UseAsyncStateOptions {
  initialData?: any;
  onSuccess?: (data: any) => void;
  onError?: (error: Error) => void;
}

export function useAsyncState<T>(
  asyncFunction?: (...args: any[]) => Promise<T>,
  options: UseAsyncStateOptions = {}
) {
  const [state, setState] = useState<AsyncState<T>>({
    data: options.initialData || null,
    loading: false,
    error: null,
  });

  // Track the current execution to avoid race conditions
  const currentExecution = useRef<number>(0);

  const execute = useCallback(
    async (...args: any[]) => {
      if (!asyncFunction) return;

      const executionId = ++currentExecution.current;
      setState(prev => ({ ...prev, loading: true, error: null }));

      try {
        const result = await asyncFunction(...args);
        
        // Only update state if this is still the current execution
        if (executionId === currentExecution.current) {
          setState({ data: result, loading: false, error: null });
          options.onSuccess?.(result);
        }
      } catch (error) {
        if (executionId === currentExecution.current) {
          const errorObj = error instanceof Error ? error : new Error('Unknown error');
          setState(prev => ({ ...prev, loading: false, error: errorObj }));
          options.onError?.(errorObj);
        }
      }
    },
    [asyncFunction, options]
  );

  const reset = useCallback(() => {
    currentExecution.current++;
    setState({
      data: options.initialData || null,
      loading: false,
      error: null,
    });
  }, [options.initialData]);

  const setData = useCallback((data: T | null) => {
    setState(prev => ({ ...prev, data }));
  }, []);

  const setError = useCallback((error: Error | null) => {
    setState(prev => ({ ...prev, error, loading: false }));
  }, []);

  return {
    ...state,
    execute,
    reset,
    setData,
    setError,
    isIdle: !state.loading && !state.error && state.data === null,
  };
}

// Specialized hook for data fetching
export function useAsyncData<T>(
  fetchFunction: () => Promise<T>,
  dependencies: any[] = []
) {
  const { data, loading, error, execute } = useAsyncState(fetchFunction);

  React.useEffect(() => {
    execute();
  }, dependencies);

  return { data, loading, error, refetch: execute };
}
```

#### 4. Enhanced Button Component

```tsx
// src/components/ui/Button.tsx
import React from 'react';
import { LoadingSpinner } from './LoadingSpinner';

interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {
  variant?: 'primary' | 'secondary' | 'danger' | 'ghost' | 'success';
  size?: 'xs' | 'sm' | 'md' | 'lg';
  loading?: boolean;
  loadingText?: string;
  icon?: React.ReactNode;
  iconPosition?: 'left' | 'right';
  children: React.ReactNode;
}

export const Button: React.FC<ButtonProps> = ({
  variant = 'primary',
  size = 'md',
  loading = false,
  loadingText,
  icon,
  iconPosition = 'left',
  children,
  disabled,
  className = '',
  ...props
}) => {
  const baseClasses = 'inline-flex items-center justify-center font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed';
  
  const variantClasses = {
    primary: 'bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500',
    secondary: 'bg-gray-200 hover:bg-gray-300 text-gray-900 focus:ring-gray-500',
    danger: 'bg-red-600 hover:bg-red-700 text-white focus:ring-red-500',
    ghost: 'hover:bg-gray-100 text-gray-700 focus:ring-gray-500',
    success: 'bg-green-600 hover:bg-green-700 text-white focus:ring-green-500',
  };
  
  const sizeClasses = {
    xs: 'px-2.5 py-1.5 text-xs',
    sm: 'px-3 py-2 text-sm',
    md: 'px-4 py-2 text-sm',
    lg: 'px-6 py-3 text-base',
  };

  const spinnerSizes = {
    xs: 'xs' as const,
    sm: 'xs' as const,
    md: 'sm' as const,
    lg: 'sm' as const,
  };

  const isDisabled = disabled || loading;
  const displayText = loading && loadingText ? loadingText : children;

  return (
    <button
      className={`
        ${baseClasses}
        ${variantClasses[variant]}
        ${sizeClasses[size]}
        ${className}
      `}
      disabled={isDisabled}
      {...props}
    >
      {loading && (
        <LoadingSpinner
          size={spinnerSizes[size]}
          color={variant === 'secondary' || variant === 'ghost' ? 'gray' : 'white'}
          className="mr-2"
        />
      )}
      
      {!loading && icon && iconPosition === 'left' && (
        <span className="mr-2">{icon}</span>
      )}
      
      <span>{displayText}</span>
      
      {!loading && icon && iconPosition === 'right' && (
        <span className="ml-2">{icon}</span>
      )}
    </button>
  );
};
```

#### 5. Updated POSMenu Component

```tsx
// src/pages/pos/POSMenu.tsx
import React, { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';
import { LoadingSpinner } from '@/components/ui/LoadingSpinner';
import { ProductCardSkeleton } from '@/components/ui/LoadingSkeleton';
import { useAsyncState } from '@/hooks/useAsyncState';

interface Product {
  id: string;
  name: string;
  price: number;
  category: string;
  image_url?: string;
  stock_quantity: number;
}

interface POSMenuProps {
  selectedCategory: string;
  onCategoryChange: (category: string) => void;
  onProductSelect: (product: Product) => void;
}

export const POSMenu: React.FC<POSMenuProps> = ({
  selectedCategory,
  onCategoryChange,
  onProductSelect,
}) => {
  const [categories, setCategories] = useState<string[]>([]);
  
  // Use async state hook for products
  const {
    data: products,
    loading: productsLoading,
    error: productsError,
    execute: fetchProducts,
  } = useAsyncState(async () => {
    const query = supabase
      .from('products')
      .select('*')
      .eq('is_active', true);
      
    if (selectedCategory !== 'all') {
      query.eq('category', selectedCategory);
    }
    
    const { data, error } = await query.order('name');
    
    if (error) throw error;
    return data as Product[];
  });

  // Fetch categories
  const {
    data: categoriesData,
    loading: categoriesLoading,
    execute: fetchCategories,
  } = useAsyncState(async () => {
    const { data, error } = await supabase
      .from('products')
      .select('category')
      .eq('is_active', true);
      
    if (error) throw error;
    
    const uniqueCategories = [...new Set(data.map(p => p.category))];
    return ['all', ...uniqueCategories];
  });

  useEffect(() => {
    fetchCategories();
  }, []);

  useEffect(() => {
    if (categoriesData) {
      setCategories(categoriesData);
    }
  }, [categoriesData]);

  useEffect(() => {
    fetchProducts();
  }, [selectedCategory]);

  const handleProductClick = (product: Product) => {
    if (product.stock_quantity > 0) {
      onProductSelect(product);
    }
  };

  if (productsError) {
    return (
      <div className="flex flex-col items-center justify-center p-8 text-center">
        <div className="text-red-600 mb-4">
          <svg className="w-12 h-12 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
          </svg>
        </div>
        <h3 className="text-lg font-medium text-gray-900 mb-2">
          Erreur de chargement
        </h3>
        <p className="text-gray-600 mb-4">
          {productsError.message}
        </p>
        <button
          onClick={fetchProducts}
          className="inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"
        >
          <svg className="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
          Réessayer
        </button>
      </div>
    );
  }

  return (
    <div className="h-full flex flex-col">
      {/* Categories */}
      <div className="flex-shrink-0 border-b border-gray-200 pb-4 mb-4">
        <div className="flex gap-2 overflow-x-auto pb-2">
          {categoriesLoading ? (
            <div className="flex gap-2">
              {[...Array(5)].map((_, i) => (
                <div key={i} className="h-10 w-24 bg-gray-200 rounded-md animate-pulse flex-shrink-0" />
              ))}
            </div>
          ) : (
            categories.map((category) => (
              <button
                key={category}
                onClick={() => onCategoryChange(category)}
                className={`
                  flex-shrink-0 px-4 py-2 rounded-md text-sm font-medium transition-colors
                  ${selectedCategory === category
                    ? 'bg-blue-600 text-white'
                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }
                `}
              >
                {category === 'all' ? 'Tous' : category}
              </button>
            ))
          )}
        </div>
      </div>

      {/* Products Grid */}
      <div className="flex-1 overflow-y-auto">
        {productsLoading ? (
          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {[...Array(8)].map((_, i) => (
              <ProductCardSkeleton key={i} />
            ))}
          </div>
        ) : products && products.length > 0 ? (
          <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            {products.map((product) => (
              <div
                key={product.id}
                onClick={() => handleProductClick(product)}
                className={`
                  bg-white border border-gray-200 rounded-lg p-4 cursor-pointer transition-all
                  ${product.stock_quantity > 0
                    ? 'hover:shadow-lg hover:border-blue-300 hover:scale-105'
                    : 'opacity-50 cursor-not-allowed'
                  }
                `}
              >
                <div className="aspect-square bg-gray-100 rounded-md mb-3 flex items-center justify-center">
                  {product.image_url ? (
                    <img
                      src={product.image_url}
                      alt={product.name}
                      className="w-full h-full object-cover rounded-md"
                    />
                  ) : (
                    <div className="text-gray-400">
                      <svg className="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                      </svg>
                    </div>
                  )}
                </div>
                
                <h3 className="font-medium text-gray-900 mb-1 line-clamp-2">
                  {product.name}
                </h3>
                
                <div className="flex justify-between items-center">
                  <span className="text-lg font-bold text-blue-600">
                    Rp {product.price.toLocaleString()}
                  </span>
                  <span className={`text-xs px-2 py-1 rounded-full ${
                    product.stock_quantity > 0
                      ? 'bg-green-100 text-green-800'
                      : 'bg-red-100 text-red-800'
                  }`}>
                    Stock: {product.stock_quantity}
                  </span>
                </div>
              </div>
            ))}
          </div>
        ) : (
          <div className="text-center py-12">
            <svg className="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
            </svg>
            <h3 className="text-lg font-medium text-gray-900 mb-1">
              Aucun produit trouvé
            </h3>
            <p className="text-gray-500">
              {selectedCategory === 'all' 
                ? 'Aucun produit disponible.'
                : `Aucun produit dans la catégorie "${selectedCategory}".`
              }
            </p>
          </div>
        )}
      </div>
    </div>
  );
};
```

#### 6. Updated InventoryTable Component

```tsx
// src/pages/inventory/InventoryTable.tsx
import React, { useState, useEffect } from 'react';
import { supabase } from '@/lib/supabase';
import { LoadingSpinner } from '@/components/ui/LoadingSpinner';
import { TableRowSkeleton } from '@/components/ui/LoadingSkeleton';
import { Button } from '@/components/ui/Button';
import { useAsyncState } from '@/hooks/useAsyncState';

interface Product {
  id: string;
  name: string;
  category: string;
  price: number;
  stock_quantity: number;
  min_stock: number;
  is_active: boolean;
  updated_at: string;
}

export const InventoryTable: React.FC = () => {
  const [searchTerm, setSearchTerm] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');

  const {
    data: products,
    loading,
    error,
    execute: fetchProducts,
  } = useAsyncState(async () => {
    let query = supabase
      .from('products')
      .select('*')
      .order('name');

    if (selectedCategory !== 'all') {
      query = query.eq('category', selectedCategory);
    }

    if (searchTerm.trim()) {
      query = query.ilike('name', `%${searchTerm}%`);
    }

    const { data, error } = await query;
    if (error) throw error;
    return data as Product[];
  });

  const {
    data: categories,
    execute: fetchCategories,
  } = useAsyncState(async () => {
    const { data, error } = await supabase
      .from('products')
      .select('category')
      .eq('is_active', true);
      
    if (error) throw error;
    return [...new Set(data.map(p => p.category))];
  });

  const {
    loading: updating,
    execute: updateStock,
  } = useAsyncState(async (productId: string, newQuantity: number) => {
    const { error } = await supabase
      .from('products')
      .update({ stock_quantity: newQuantity })
      .eq('id', productId);
      
    if (error) throw error;
    
    // Refresh the products list
    await fetchProducts();
  });

  useEffect(() => {
    fetchCategories();
    fetchProducts();
  }, []);

  useEffect(() => {
    fetchProducts();
  }, [selectedCategory, searchTerm]);

  const handleStockUpdate = async (productId: string, newQuantity: number) => {
    if (newQuantity < 0) return;
    await updateStock(productId, newQuantity);
  };

  const getLowStockProducts = () => {
    return products?.filter(p => p.stock_quantity <= p.min_stock) || [];
  };

  if (error) {
    return (
      <div className="bg-white rounded-lg border border-gray-200 p-8">
        <div className="text-center">
          <div className="text-red-600 mb-4">
            <svg className="w-12 h-12 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
            </svg>
          </div>
          <h3 className="text-lg font-medium text-gray-900 mb-2">
            Erreur de chargement de l'inventaire
          </h3>
          <p className="text-gray-600 mb-4">{error.message}</p>
          <Button onClick={fetchProducts}>
            Réessayer
          </Button>
        </div>
      </div>
    );
  }

  return (
    <div className="space-y-6">
      {/* Alert for low stock */}
      {products && getLowStockProducts().length > 0 && (
        <div className="bg-yellow-50 border border-yellow-200 rounded-md p-4">
          <div className="flex">
            <div className="flex-shrink-0">
              <svg className="h-5 w-5 text-yellow-400" viewBox="0 0 20 20" fill="currentColor">
                <path fillRule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
              </svg>
            </div>
            <div className="ml-3">
              <h3 className="text-sm font-medium text-yellow-800">
                Stock faible détecté
              </h3>
              <div className="mt-2 text-sm text-yellow-700">
                <p>{getLowStockProducts().length} produit(s) ont un stock faible ou épuisé.</p>
              </div>
            </div>
          </div>
        </div>
      )}

      {/* Filters */}
      <div className="bg-white p-4 rounded-lg border border