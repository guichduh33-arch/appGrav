{
  "module": "customers",
  "description": "Gestion des clients et fidélité",
  "tables": {
    "customers": {
      "description": "Base clients",
      "columns": {
        "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
        "code": "VARCHAR(20) UNIQUE",
        "name": "VARCHAR(255) NOT NULL",
        "email": "VARCHAR(255)",
        "phone": "VARCHAR(50)",
        "address": "TEXT",
        "customer_type": "VARCHAR(20) DEFAULT 'retail'",
        "loyalty_points": "INTEGER DEFAULT 0",
        "total_purchases": "DECIMAL(15,2) DEFAULT 0",
        "notes": "TEXT",
        "is_active": "BOOLEAN DEFAULT true",
        "created_at": "TIMESTAMPTZ DEFAULT NOW()",
        "updated_at": "TIMESTAMPTZ DEFAULT NOW()"
      },
      "indexes": [
        "CREATE INDEX idx_customers_phone ON customers(phone)",
        "CREATE INDEX idx_customers_type ON customers(customer_type)"
      ],
      "rls": true
    },
    "loyalty_transactions": {
      "description": "Historique des points fidélité",
      "columns": {
        "id": "UUID PRIMARY KEY DEFAULT gen_random_uuid()",
        "customer_id": "UUID REFERENCES customers(id) NOT NULL",
        "transaction_type": "VARCHAR(20) NOT NULL",
        "points": "INTEGER NOT NULL",
        "reference_type": "VARCHAR(50)",
        "reference_id": "UUID",
        "notes": "TEXT",
        "created_at": "TIMESTAMPTZ DEFAULT NOW()"
      },
      "rls": true
    }
  },
  "rules": {
    "points_calculation": "1 point = 1000 IDR dépensés",
    "redemption_threshold": 100,
    "redemption_discount": 0.1
  }
}